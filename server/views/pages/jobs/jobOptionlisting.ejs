
  <%- include('../../layouts/common/header.ejs') %>
       <div class="container-scroller">
     <%- include('../../layouts/common/navbar.ejs') %>
     <div class="container-fluid page-body-wrapper">
         <%- include("../../layouts/common/main.ejs") %>
          <div class="main-panel">
    <div class="content-wrapper">
      <div class="row">
          <!-- <div class="page-header">
              <h3 class="page-title"> Form elements </h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Forms</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Form elements</li>
                </ol>
              </nav>
            </div> -->
              <div class="col-12 grid-margin">
                <div class="card">
                  <div class="card-body">
                 <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="card-title mb-0">Job Option</h4>
        <a href="/admin/joboptionCreate" class="btn  text-white"style='background-color: #157B6C;'>
          <i class="fas fa-plus"></i> Create Job Option
        </a>
      </div>
                    <div class="table-responsive">
                      <table class="table">
                        <thead>
                          <tr>
                            <th> Sr.No </th>
                            <th> Job </th>
                            <th> Location </th>
                            <th> Responsibilities	 </th>
                            <th> Requirements </th>
                            <th> Experience </th>
                            <th> Status </th>
                            <th> Action </th>
                          </tr>
                        </thead>
                        <tbody>
                               <% jobs.forEach((job, index) => { %>
                          <tr id="job-<%= job.id %>">
                          <td><%= index + 1 %></td>
                           <td><%= job.jobtitle?.title %></td>
                           <td><%= job.location %></td>
                          <td><%= job.responsibilities %></td>
                          <td><%= job.requirements %></td>
                          <td><%= job.experience %></td>
                          <td>
  <button class="btn <%= job.status == 1 ? 'btn-success' : 'btn-danger' %> btn-sm toggle-status" 
          data-id="<%= job.id %>" 
          data-status="<%= job.status == 1 ? '1' : '0' %>" 
          title="Toggle Status">
    <%= job.status == 1 ? 'Active' : 'Inactive' %>
  </button>
</td>
      <td>
        <a href="/admin/joboption/<%= job.id %>"  title="View">
          <i class="fas fa-edit text-primary fa-lg"></i>
        </a>
  
      </td>
                          </tr>
                              <% }) %>
                       
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            </div>
            </div>
            </div>
            </div>
            <%- include('../../layouts/common/footer.ejs') %>


             <script>

                  $(document).on('click', '.toggle-status', function() {
    const jobId = $(this).data('id');
    const currentStatus = $(this).data('status');
    const newStatus = currentStatus ===  '1' ? '0' : '1';

    // Send an AJAX request to update the status in the database
    $.ajax({
      url: '/admin/joboption/' + jobId + '/status',
      type: 'PUT',
      data: {
        status: newStatus
      },
    success: function(response) {
  if (response.success) {
    const button = $('.toggle-status[data-id="' + jobId + '"]');
    if (newStatus === '1') {
      button.text('Active').removeClass('btn-danger').addClass('btn-success');
    } else {
      button.text('Inactive').removeClass('btn-success').addClass('btn-danger');
    }
    button.data('status', newStatus);
  }
},
      error: function() {
        console.error('Error while updating the spaCenter\'s status');
      }
    });
  });
             </script>